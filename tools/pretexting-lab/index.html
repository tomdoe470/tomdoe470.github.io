<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pretexting Defense Lab | Elite Edition</title>
    <style>
        /* --- FUENTES: Inter para UI limpia, JetBrains Mono para toque Cyber --- */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=JetBrains+Mono:wght@400;700&display=swap');

        :root {
            /* Paleta Base Cyber-Dark */
            --bg-deep: #020617;
            --bg-panel: #0f172a;
            --bg-element: #1e293b;
            
            /* Colores de Estado/Acci√≥n */
            --primary: #3b82f6;       /* Azul El√©ctrico */
            --primary-glow: rgba(59, 130, 246, 0.5);
            --accent-green: #10b981;  /* Verde Terminal */
            --accent-red: #f43f5e;    /* Rojo Alerta */
            --accent-gold: #f59e0b;   /* Escasez/Codicia */
            --accent-purple: #a855f7; /* Curiosidad */
            --accent-teal: #14b8a6;   /* Quid Pro Quo */

            /* Texto */
            --text-main: #f1f5f9;
            --text-muted: #64748b;
            --font-ui: 'Inter', sans-serif;
            --font-code: 'JetBrains Mono', monospace;

            /* Bordes y Efectos */
            --border: 1px solid rgba(148, 163, 184, 0.1);
            --shadow-neon: 0 0 15px rgba(59, 130, 246, 0.2);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }

        body {
            font-family: var(--font-ui);
            background-color: var(--bg-deep);
            color: var(--text-main);
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            background-image: 
                linear-gradient(rgba(255, 255, 255, 0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
            background-size: 40px 40px;
        }

        /* --- NAVIGATION --- */
        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            background: rgba(2, 6, 23, 0.8);
            backdrop-filter: blur(100px);
            border-bottom: var(--border);
            z-index: 100;
        }

        .logo { 
            font-family: var(--font-code);
            font-weight: 700; 
            font-size: 1.1rem; 
            letter-spacing: -0.5px;
            display: flex; 
            align-items: center; 
            gap: 12px; 
        }
        
        .nav-links button {
            background: transparent;
            border: none;
            color: var(--text-muted);
            margin-left: 25px;
            font-family: var(--font-code);
            font-size: 0.85rem;
            cursor: pointer;
            transition: 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .nav-links button:hover, .nav-links button.active { 
            color: var(--primary); 
            text-shadow: 0 0 10px rgba(59, 130, 246, 0.4);
        }
        
        .btn-launch {
            background: linear-gradient(135deg, var(--accent-green), #059669);
            color: #022c22 !important;
            padding: 8px 20px;
            border-radius: 4px;
            font-weight: 700 !important;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.2);
        }
        .btn-launch:hover { box-shadow: 0 0 25px rgba(16, 185, 129, 0.4); transform: translateY(-1px); }

        /* --- VIEWS SYSTEM --- */
        .view { display: none; height: 100%; overflow-y: auto; position: relative; }
        .view.active { display: flex; animation: fadeIn 0.4s ease-out; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- HOME VIEW (Matrix Redesigned) --- */
        #home-view { flex-direction: column; justify-content: center; align-items: center; text-align: center; }
        
        canvas { position: absolute; top: 0; left: 0; z-index: -1; opacity: 0.15; }

        .hero-badge {
            font-family: var(--font-code);
            font-size: 0.75rem;
            color: var(--accent-green);
            border: 1px solid var(--accent-green);
            padding: 6px 12px;
            border-radius: 20px;
            margin-bottom: 25px;
            background: rgba(16, 185, 129, 0.05);
            box-shadow: 0 0 20px rgba(16, 185, 129, 0.1);
        }

        .hero-title { font-size: 4.5rem; font-weight: 800; line-height: 1.1; letter-spacing: -2px; margin-bottom: 20px; text-transform: uppercase;}
        .hero-title span { 
            background: linear-gradient(to right, #3b82f6, #8b5cf6); 
            -webkit-background-clip: text; 
            -webkit-text-fill-color: transparent; 
        }

        .hero-desc { color: var(--text-muted); font-size: 1.1rem; max-width: 600px; margin: 0 auto 40px; line-height: 1.6; }

        .cta-group { display: flex; gap: 20px; }
        .btn-hero {
            padding: 14px 32px;
            border-radius: 6px;
            font-family: var(--font-code);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }
        .btn-primary {
            background: var(--primary);
            border: none;
            color: white;
            box-shadow: var(--shadow-neon);
        }
        .btn-primary:hover { background: #2563eb; box-shadow: 0 0 30px rgba(59, 130, 246, 0.5); }
        
        .btn-secondary {
            background: transparent;
            border: 1px solid var(--text-muted);
            color: var(--text-main);
        }
        .btn-secondary:hover { border-color: var(--text-main); background: rgba(255,255,255,0.05); }

        /* --- METHODOLOGIES (Styled Flip Cards) --- */
        #methodologies-view { flex-direction: column; padding: 60px; align-items: center; }
        
        .section-header { text-align: center; margin-bottom: 50px; }
        .section-header h2 { font-size: 2.5rem; margin-bottom: 10px; }
        
        .cards-grid { display: flex; gap: 30px; justify-content: center; flex-wrap: wrap; max-width: 1200px; margin-bottom: 40px;}
        
        .flip-card { background-color: transparent; width: 340px; height: 420px; perspective: 1000px; cursor: pointer; margin-bottom: 20px; }
        .flip-card-inner { position: relative; width: 100%; height: 100%; text-align: center; transition: transform 0.8s cubic-bezier(0.175, 0.885, 0.32, 1.275); transform-style: preserve-3d; }
        .flip-card.flipped .flip-card-inner { transform: rotateY(180deg); }
        
        .flip-card-front, .flip-card-back {
            position: absolute; width: 100%; height: 100%;
            -webkit-backface-visibility: hidden; backface-visibility: hidden;
            border-radius: 16px; padding: 30px; display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            box-shadow: 0 10px 30px -10px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
        }

        /* Card Colors */
        .style-auth .flip-card-front { background: linear-gradient(145deg, #1e3a8a, #172554); }
        .style-urge .flip-card-front { background: linear-gradient(145deg, #7f1d1d, #450a0a); }
        .style-trust .flip-card-front { background: linear-gradient(145deg, #064e3b, #022c22); }
        .style-curiosity .flip-card-front { background: linear-gradient(145deg, #581c87, #3b0764); }
        .style-scarcity .flip-card-front { background: linear-gradient(145deg, #78350f, #451a03); }
        .style-quid .flip-card-front { background: linear-gradient(145deg, #0f766e, #115e59); }

        .card-icon-circle {
            width: 80px; height: 80px; border-radius: 50%; 
            background: rgba(255,255,255,0.1); display: flex; align-items: center; justify-content: center;
            font-size: 2.5rem; margin-bottom: 20px;
            backdrop-filter: blur(5px);
        }

        .flip-card h3 { font-family: var(--font-code); font-size: 1.4rem; margin-bottom: 10px; letter-spacing: -0.5px; }
        .reveal-hint { margin-top: auto; font-size: 0.7rem; text-transform: uppercase; letter-spacing: 2px; opacity: 0.7; }

        .flip-card-back {
            background: var(--bg-element);
            transform: rotateY(180deg);
            align-items: flex-start; text-align: left;
            border: 1px solid rgba(255,255,255,0.1);
        }
        .flip-card-back h4 { color: var(--primary); font-family: var(--font-code); margin-bottom: 15px; text-transform: uppercase; font-size: 0.9rem; }
        .example-box {
            background: rgba(0,0,0,0.3); padding: 15px; border-radius: 8px; 
            border-left: 3px solid var(--text-muted); margin-top: 20px;
            font-family: var(--font-code); font-size: 0.8rem; color: #e2e8f0;
        }

        /* --- SIMULATOR (Dashboard UI) --- */
        #simulator-view { padding: 0; height: calc(100vh - 70px); display: none; }
        #simulator-view.active { display: flex; }

        /* Left Control Panel */
        .sim-sidebar {
            width: 380px;
            background: var(--bg-panel);
            border-right: var(--border);
            padding: 30px;
            display: flex; flex-direction: column; gap: 25px;
            box-shadow: 5px 0 20px rgba(0,0,0,0.2);
            z-index: 10;
        }

        .panel-title { font-family: var(--font-code); font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; }

        .scenario-item {
            padding: 15px;
            border-radius: 8px;
            background: rgba(255,255,255,0.03);
            border: 1px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
        }
        .scenario-item:hover { background: rgba(255,255,255,0.05); }
        .scenario-item.active {
            background: rgba(59, 130, 246, 0.1);
            border: 1px solid var(--primary);
            box-shadow: 0 0 15px rgba(59, 130, 246, 0.1);
        }

        .sc-header { display: flex; justify-content: space-between; margin-bottom: 5px; font-weight: 600; }
        .badge { font-size: 0.65rem; padding: 2px 6px; border-radius: 4px; font-family: var(--font-code); }
        .badge-easy { background: rgba(16, 185, 129, 0.2); color: var(--accent-green); }
        .badge-med { background: rgba(59, 130, 246, 0.2); color: var(--primary); }
        .badge-hard { background: rgba(244, 63, 94, 0.2); color: var(--accent-red); }

        .analysis-box {
            margin-top: auto;
            padding: 20px;
            background: #020617;
            border-radius: 12px;
            border: var(--border);
        }
        
        select {
            width: 100%;
            background: var(--bg-element);
            color: white;
            padding: 12px;
            border: var(--border);
            border-radius: 6px;
            margin: 15px 0;
            font-family: var(--font-ui);
        }

        /* Right Viewport */
        .sim-viewport {
            flex: 1;
            background: #000;
            background-image: radial-gradient(#1e293b 1px, transparent 1px);
            background-size: 20px 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 40px;
            position: relative;
        }

        /* Mockup Windows */
        .os-window {
            width: 100%; max-width: 700px;
            background: var(--bg-element);
            border-radius: 10px;
            box-shadow: 0 25px 50px -12px rgba(0,0,0,0.8);
            border: 1px solid rgba(255,255,255,0.1);
            overflow: hidden;
            display: none;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .os-window.active { display: block; }

        @keyframes popIn { from { opacity: 0; transform: scale(0.95); } to { opacity: 1; transform: scale(1); } }

        .window-bar {
            background: #0f172a;
            padding: 12px 15px;
            display: flex; align-items: center; gap: 8px;
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .traffic-light { width: 10px; height: 10px; border-radius: 50%; }
        .tl-red { background: #ef4444; } .tl-yellow { background: #f59e0b; } .tl-green { background: #22c55e; }
        
        .address-bar {
            margin-left: 15px; flex: 1;
            background: #1e293b; color: var(--text-muted);
            font-size: 0.75rem; padding: 4px 10px; border-radius: 4px;
            text-align: center; font-family: var(--font-code);
            display: flex; justify-content: center; align-items: center; gap: 6px;
        }

        /* Email Content */
        .email-body { padding: 40px; background: #ffffff; color: #1e293b; }
        .email-meta { border-bottom: 1px solid #e2e8f0; padding-bottom: 20px; margin-bottom: 20px; }
        .sender-tag { 
            background: #fee2e2; color: #991b1b; 
            padding: 2px 6px; border-radius: 4px; font-size: 0.8rem; font-family: var(--font-code);
        }

        /* Chat Content */
        .chat-body { padding: 30px; background: #0f172a; display: flex; flex-direction: column; gap: 20px; }
        .chat-row { display: flex; gap: 15px; }
        .avatar { width: 40px; height: 40px; border-radius: 8px; background: #6366f1; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .bubble { background: #1e293b; padding: 15px; border-radius: 0 12px 12px 12px; color: #e2e8f0; font-size: 0.95rem; line-height: 1.5; border: 1px solid rgba(255,255,255,0.05); }
        .msg-name { color: #818cf8; font-size: 0.75rem; font-weight: 700; margin-bottom: 4px; display: block; }

        /* WhatsApp Style */
        .wsp-header { background: #202c33; color: #e9edef; padding: 10px 15px; display: flex; align-items: center; gap: 15px; }
        .wsp-avatar { width: 40px; height: 40px; border-radius: 50%; background: #00a884; display: flex; align-items: center; justify-content: center; font-size: 1.2rem; }
        .wsp-body { background: #0b141a; padding: 20px; display: flex; flex-direction: column; gap: 10px; background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png'); background-size: 300px; }
        .wsp-msg { max-width: 70%; padding: 8px 10px; border-radius: 8px; font-size: 0.9rem; line-height: 1.4; position: relative; }
        .wsp-in { background: #202c33; align-self: flex-start; color: #e9edef; }
        .wsp-out { background: #005c4b; align-self: flex-end; color: #e9edef; }
        .wsp-time { font-size: 0.65rem; color: #8696a0; text-align: right; margin-top: 4px; }

        /* --- COACHING & MODAL SYSTEM --- */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(2, 6, 23, 0.9); backdrop-filter: blur(10px);
            display: none; justify-content: center; align-items: center; z-index: 1000;
            animation: fadeIn 0.3s;
        }
        .modal-card {
            background: var(--bg-element); width: 800px; max-height: 90vh;
            border-radius: 16px; border: var(--border); overflow-y: auto;
            box-shadow: 0 20px 50px rgba(0,0,0,0.7); display: none;
        }
        .modal-header {
            padding: 20px 30px; border-bottom: var(--border); display: flex; justify-content: space-between;
            align-items: center; background: var(--bg-panel);
        }
        .modal-body { padding: 30px; }

        /* Defensive Phase */
        .defense-options { display: flex; flex-direction: column; gap: 15px; }
        .def-btn {
            padding: 20px; text-align: left; background: var(--bg-deep);
            border: 1px solid rgba(255,255,255,0.1); color: var(--text-main);
            border-radius: 8px; cursor: pointer; transition: 0.2s;
            font-size: 1rem; display: flex; align-items: center; gap: 15px;
        }
        .def-btn:hover { border-color: var(--primary); background: rgba(59, 130, 246, 0.05); }
        .def-icon { font-size: 1.5rem; }

        /* Analysis Phase */
        .coach-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .coach-box { background: rgba(255,255,255,0.03); padding: 20px; border-radius: 8px; }
        .coach-label { color: var(--text-muted); font-size: 0.75rem; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px; display: block; font-weight: 700;}
        .highlight-red { color: var(--accent-red); font-weight: 600; }
        .highlight-green { color: var(--accent-green); font-weight: 600; }
        .quote { font-style: italic; border-left: 2px solid var(--primary); padding-left: 10px; color: #e2e8f0; margin: 5px 0; }

        /* Toast */
        .toast {
            position: fixed; top: 30px; right: 30px;
            background: var(--bg-element); border-left: 4px solid var(--accent-green);
            padding: 20px 30px; border-radius: 4px; box-shadow: 0 20px 40px rgba(0,0,0,0.5);
            transform: translateX(150%); transition: transform 0.4s cubic-bezier(0.68, -0.55, 0.27, 1.55);
            z-index: 2000; display: flex; align-items: center; gap: 15px;
        }
        .toast.show { transform: translateX(0); }
        .toast.error { border-left-color: var(--accent-red); }

    </style>
</head>
<body>

    <nav>
        <div class="logo">
            <span style="color: var(--primary)">//</span> PRETEXT_LAB
        </div>
        <div class="nav-links">
            <button onclick="navTo('home')" class="active">Home</button>
            <button onclick="navTo('methodologies')">Intel</button>
            <button onclick="navTo('simulator')" class="btn-launch">LAUNCH SIM</button>
        </div>
    </nav>

    <div id="home-view" class="view active">
        <canvas id="matrix"></canvas>
        <div style="position: relative; z-index: 2;">
            <div class="hero-badge">v3.0 // COACHING MODULE ACTIVE</div>
            <h1 class="hero-title">DECONSTRUCT THE ART OF<br><span>DECEPTION</span></h1>
            <p class="hero-desc">Interactive training environment designed to deconstruct social engineering attacks. Analyze payloads, identify pretexts, and harden your human firewall.</p>
            <div class="cta-group">
                <button class="btn-hero btn-secondary" onclick="navTo('methodologies')">VIEW VECTORS</button>
                <button class="btn-hero btn-primary" onclick="navTo('simulator')">START SIMULATION_</button>
            </div>
        </div>
    </div>

    <div id="methodologies-view" class="view">
        <div class="section-header">
            <div style="font-family: var(--font-code); color: var(--primary); margin-bottom: 10px;">KNOWLEDGE BASE</div>
            <h2>Core Pretexting Vectors</h2>
        </div>

        <div class="cards-grid">
            <div class="flip-card style-auth" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">üëÆ‚Äç‚ôÇÔ∏è</div>
                        <h3>Authority</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Impersonating executives, legal entities, or sysadmins.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: #60a5fa">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">Targets are conditioned to comply with superiors to avoid insubordination.</p>
                        <div class="example-box" style="border-color: #60a5fa">
                            > "This is the CEO. Wire funds for acquisition Project X immediately."
                        </div>
                    </div>
                </div>
            </div>
            <div class="flip-card style-urge" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">üß®</div>
                        <h3>Urgency</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Demanding immediate action to prevent disaster.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: var(--accent-red)">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">Fear induces cognitive tunneling. When victims believe time is running out, critical thinking is suspended.</p>
                        <div class="example-box" style="border-color: var(--accent-red)">
                            > "Account suspension in 5 min. Verify credentials NOW."
                        </div>
                    </div>
                </div>
            </div>
            <div class="flip-card style-trust" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">ü§ù</div>
                        <h3>Trust & Rapport</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Leveraging OSINT to appear as a friend or colleague.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: var(--accent-green)">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">Building familiarity lowers natural defenses. Attackers mine social media for shared interests.</p>
                        <div class="example-box" style="border-color: var(--accent-green)">
                            > "Loved your Bali pics! Btw, can you send that Q3 sheet?"
                        </div>
                    </div>
                </div>
            </div>
            <div class="flip-card style-curiosity" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">üßê</div>
                        <h3>Curiosity</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Enticing the victim with hidden or forbidden information.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: var(--accent-purple)">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">Humans have an innate desire to know the unknown. Vague filenames trigger clicks.</p>
                        <div class="example-box" style="border-color: var(--accent-purple)">
                            > "Fwd: Layoff_Plan_Q4_FINAL.docx - Do not share"
                        </div>
                    </div>
                </div>
            </div>
            <div class="flip-card style-scarcity" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">üíé</div>
                        <h3>Scarcity</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Creating a false sense of limited availability.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: var(--accent-gold)">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">FOMO drives impulsive action. Offers that seem "too good to be true" usually are.</p>
                        <div class="example-box" style="border-color: var(--accent-gold)">
                            > "Only 2 spots left for the Executive Bonus Program."
                        </div>
                    </div>
                </div>
            </div>
            <div class="flip-card style-quid" onclick="this.classList.toggle('flipped')">
                <div class="flip-card-inner">
                    <div class="flip-card-front">
                        <div class="card-icon-circle">üéÅ</div>
                        <h3>Quid Pro Quo</h3>
                        <p style="font-size: 0.9rem; margin-top: 15px; opacity: 0.8;">Offering a benefit or service in exchange for info.</p>
                        <div class="reveal-hint">Click to Decrypt</div>
                    </div>
                    <div class="flip-card-back">
                        <h4 style="color: var(--accent-teal)">Vector Analysis</h4>
                        <p style="font-size: 0.9rem; line-height: 1.6;">"Something for something". Attackers offer help (often technical) to get credentials.</p>
                        <div class="example-box" style="border-color: var(--accent-teal)">
                            > "I can fix that slow network speed, just need your pass."
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="simulator-view" class="view">
        <aside class="sim-sidebar">
            <div>
                <div class="panel-title">INCOMING THREATS</div>
                <div class="scenario-item active" onclick="loadSim('ceo')" id="btn-ceo">
                    <div class="sc-header">
                        <span>The 'Urgent' CEO</span>
                        <span class="badge badge-med">MEDIUM</span>
                    </div>
                    <div style="font-size: 0.8rem; color: var(--text-muted)">Email payload from high-value target...</div>
                </div>
                <div style="height: 10px;"></div>
                <div class="scenario-item" onclick="loadSim('it')" id="btn-it">
                    <div class="sc-header">
                        <span>IT Support Reset</span>
                        <span class="badge badge-easy">EASY</span>
                    </div>
                    <div style="font-size: 0.8rem; color: var(--text-muted)">Direct message requesting auth tokens...</div>
                </div>
                <div style="height: 10px;"></div>
                <div class="scenario-item" onclick="loadSim('job')" id="btn-job">
                    <div class="sc-header">
                        <span>Dream Job Recruiter</span>
                        <span class="badge badge-hard">HARD</span>
                    </div>
                    <div style="font-size: 0.8rem; color: var(--text-muted)">LinkedIn lure with malicious attachment...</div>
                </div>
                <div style="height: 10px;"></div>
                <div class="scenario-item" onclick="loadSim('wsp')" id="btn-wsp">
                    <div class="sc-header">
                        <span>Vendor Pay Update</span>
                        <span class="badge badge-med">MEDIUM</span>
                    </div>
                    <div style="font-size: 0.8rem; color: var(--text-muted)">WhatsApp msg from known supplier...</div>
                </div>
            </div>

            <div class="analysis-box">
                <div class="panel-title" style="color: var(--primary)">ANALYST CONSOLE</div>
                <p style="font-size: 0.85rem;">Identify the primary psychological lever:</p>
                <select id="analysis-select">
                    <option value="">-- Select Vector --</option>
                    <option value="authority">Abuse of Authority</option>
                    <option value="urgency">False Sense of Urgency</option>
                    <option value="rapport">Fabricated Rapport</option>
                    <option value="curiosity">Curiosity / Mystery</option>
                    <option value="scarcity">Scarcity / Greed</option>
                    <option value="quidproquo">Quid Pro Quo</option>
                </select>
                <button class="btn-hero btn-primary" style="width: 100%; margin-top: 10px;" onclick="submitAnalysis()">SUBMIT REPORT</button>
            </div>
        </aside>

        <main class="sim-viewport">
            <div id="sim-ceo" class="os-window active">
                <div class="window-bar">
                    <div class="traffic-light tl-red"></div><div class="traffic-light tl-yellow"></div><div class="traffic-light tl-green"></div>
                    <div class="address-bar">üîí mail.corp-internal.net</div>
                </div>
                <div class="email-body">
                    <div class="email-meta">
                        <h2 style="font-size: 1.4rem; margin-bottom: 10px;">URGENT: Wire Transfer Required</h2>
                        <div style="font-size: 0.9rem;"><strong>From:</strong> <span class="sender-tag">e.musk@tesla-motors.com</span><br><strong style="color: #64748b">To:</strong> You (Finance Dept)</div>
                    </div>
                    <div style="font-family: serif; font-size: 1.1rem; line-height: 1.6;">
                        <p style="margin-bottom: 15px;">Hi,</p>
                        <p style="margin-bottom: 15px;">I'm currently stuck in a meeting with partners in Tokyo and my company card is being declined. This is embarrassing and critical for the acquisition deal.</p>
                        <p style="margin-bottom: 15px;">Process an immediate wire transfer of <strong>$14,500</strong> to the vendor account attached below. Do not discuss this with anyone yet as the deal is under NDA.</p>
                        <p style="margin-bottom: 20px;">Process this NOW. I will sign paperwork when I land.</p>
                        <p style="font-style: italic; color: #64748b;">Sent from my iPhone</p>
                    </div>
                </div>
            </div>

            <div id="sim-it" class="os-window">
                <div class="window-bar">
                    <div class="traffic-light tl-red"></div><div class="traffic-light tl-yellow"></div><div class="traffic-light tl-green"></div>
                    <div class="address-bar"># slack-internal</div>
                </div>
                <div class="chat-body">
                    <div class="chat-row"><div class="avatar">ü¶Ñ</div><div class="bubble"><span class="msg-name">SysAdmin_Helpdesk</span>Hi there. We've detected a critical syncing error with your Active Directory profile. It looks like your account is flagging 403 errors on the main server.</div></div>
                    <div class="chat-row"><div class="avatar">ü¶Ñ</div><div class="bubble"><span class="msg-name">SysAdmin_Helpdesk</span>We need to re-authenticate your session token manually to prevent a lockout. <span style="color: #f87171; font-weight: bold;">Please reply with your current temporary 2FA code</span> so I can resync the database.</div></div>
                    <div style="color: var(--primary); font-size: 0.8rem; font-family: var(--font-code);">SysAdmin_Helpdesk is typing...</div>
                </div>
            </div>

            <div id="sim-job" class="os-window">
                <div class="window-bar">
                    <div class="traffic-light tl-red"></div><div class="traffic-light tl-yellow"></div><div class="traffic-light tl-green"></div>
                    <div class="address-bar">üîí linkedin.com/inbox</div>
                </div>
                <div class="email-body" style="border-top: 4px solid #0a66c2;">
                    <div class="email-meta" style="border-bottom: none;">
                        <h2 style="font-size: 1.2rem; margin-bottom: 5px;">Lead Security Architect (Remote)</h2>
                        <div style="font-size: 0.85rem; color: #64748b;">From: Sarah J. (Tech Recruiter at Gooogle)</div>
                    </div>
                    <p style="font-size: 0.9rem; line-height: 1.5; margin-bottom: 15px;">Hey! I stumbled upon your profile and I'm blown away. We have a confidential opening that fits your skills perfectly. Pays 60% above market.</p>
                    <p style="font-size: 0.9rem; line-height: 1.5; margin-bottom: 15px;">We are closing applications <strong>tonight</strong>. I've attached the full compensation breakdown and role details below.</p>
                    <div style="background: #f1f5f9; padding: 10px; border-radius: 6px; border: 1px solid #e2e8f0; display: flex; align-items: center; gap: 10px; font-weight: 600; color: #0f172a;">üìÑ Compensation_Pkg_Macro_Enabled.doc</div>
                </div>
            </div>

            <div id="sim-wsp" class="os-window">
                <div class="window-bar" style="background: #202c33; border-bottom: none;">
                    <div class="traffic-light tl-red"></div><div class="traffic-light tl-yellow"></div><div class="traffic-light tl-green"></div>
                    <div class="address-bar" style="background: #111b21; color: #aebac1;">web.whatsapp.com</div>
                </div>
                <div class="wsp-header">
                    <div class="wsp-avatar">üè¢</div>
                    <div><div style="font-weight: 600; font-size: 0.95rem;">Global Suppliers Inc. (Alex)</div><div style="font-size: 0.75rem; color: #8696a0;">online</div></div>
                </div>
                <div class="wsp-body">
                    <div class="wsp-msg wsp-in">Hey Tom! üëã Hope you're having a good week. Just wanted to flag something about Invoice #9092 for the server racks.<div class="wsp-time">10:15 AM</div></div>
                    <div class="wsp-msg wsp-out">Hi Alex. What's the issue? We scheduled that for payment this Friday.<div class="wsp-time">10:18 AM</div></div>
                    <div class="wsp-msg wsp-in">Yeah, that's the thing. Our corporate audit froze our main USD account this morning. Bureaucracy üôÑ<div class="wsp-time">10:20 AM</div></div>
                    <div class="wsp-msg wsp-in">Can you reroute the payment to our subsidiary's account in Singapore? I'll send the new IBAN now. Needs to go out today or shipping gets delayed 2 weeks. üò¨<div class="wsp-time">10:20 AM</div></div>
                </div>
            </div>
        </main>
    </div>

    <div class="modal-overlay" id="modal-overlay">
        
        <div class="modal-card" id="modal-defense">
            <div class="modal-header">
                <h3 style="color: var(--accent-gold)">‚ö†Ô∏è THREAT IDENTIFIED. INITIATE COUNTERMEASURE.</h3>
            </div>
            <div class="modal-body">
                <p style="margin-bottom: 20px; font-size: 1.1rem;">You have correctly identified the attack vector. How do you proceed? Select the most secure response.</p>
                <div class="defense-options" id="defense-options-container">
                    </div>
            </div>
        </div>

        <div class="modal-card" id="modal-analysis">
            <div class="modal-header">
                <h3 style="color: var(--primary)">üõ°Ô∏è MISSION DEBRIEF & ANALYSIS</h3>
                <button onclick="closeModal()" style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer;">&times;</button>
            </div>
            <div class="modal-body">
                <div class="coach-grid">
                    <div class="coach-box">
                        <span class="coach-label">ATTACK TECHNIQUE (CIALDINI)</span>
                        <div id="coach-tech">...</div>
                    </div>
                    <div class="coach-box">
                        <span class="coach-label">LINGUISTIC TRIGGERS (VRIJ)</span>
                        <div id="coach-ling">...</div>
                    </div>
                </div>
                <div class="coach-box" style="margin-top: 20px; border-left: 3px solid var(--accent-green);">
                    <span class="coach-label" style="color: var(--accent-green)">CORRECT DEFENSIVE PROTOCOL</span>
                    <div id="coach-proto">...</div>
                </div>
                <div style="margin-top: 20px; font-size: 0.9rem; color: var(--text-muted);">
                    <strong>Why you succeeded:</strong> <span id="coach-why"></span>
                </div>
                <button class="btn-hero btn-primary" style="width: 100%; margin-top: 20px;" onclick="closeModal()">RETURN TO LAB</button>
            </div>
        </div>

    </div>

    <div id="toast" class="toast">
        <div style="font-size: 2rem;" id="toast-icon">‚úÖ</div>
        <div>
            <h3 style="margin-bottom: 5px;" id="toast-title">Success</h3>
            <p style="font-size: 0.9rem; color: var(--text-muted);" id="toast-msg">Vector correctly identified.</p>
        </div>
    </div>

    <script>
        // --- MATRIX EFFECT ---
        const canvas = document.getElementById('matrix');
        const ctx = canvas.getContext('2d');
        function resizeCanvas() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
        window.addEventListener('resize', resizeCanvas); resizeCanvas();
        const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789$#@%&';
        const fontSize = 14; const columns = canvas.width / fontSize; const drops = Array(Math.floor(columns)).fill(1);
        function draw() {
            ctx.fillStyle = 'rgba(2, 6, 23, 0.05)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#0f0'; ctx.font = fontSize + 'px monospace';
            for (let i = 0; i < drops.length; i++) {
                const text = chars.charAt(Math.floor(Math.random() * chars.length));
                ctx.fillText(text, i * fontSize, drops[i] * fontSize);
                if (drops[i] * fontSize > canvas.height && Math.random() > 0.975) drops[i] = 0; drops[i]++;
            }
        }
        setInterval(draw, 33);

        // --- NAVIGATION ---
        function navTo(viewId) {
            document.querySelectorAll('.view').forEach(el => el.classList.remove('active'));
            document.getElementById(viewId + '-view').classList.add('active');
            document.querySelectorAll('.nav-links button').forEach(btn => btn.classList.remove('active'));
            event.currentTarget.classList.add('active');
        }

        // --- DATA: EDUCATIONAL CONTENT ---
        const scenarioData = {
            'ceo': {
                defensiveOptions: [
                    { text: "Reply immediately apologizing and asking for the account number again.", correct: false },
                    { text: "Call the CEO's Executive Assistant (EA) on a known internal line to verify.", correct: true },
                    { text: "Forward the email to the vendor to check if they are real.", correct: false }
                ],
                analysis: {
                    tech: "<strong>Authority & Scarcity:</strong> The attacker poses as a high-level executive to bypass scrutiny and claims to be 'unavailable' (in a meeting) to prevent voice verification.",
                    ling: "Use of <strong>Imperative Language</strong> ('Process this NOW') and <strong>Isolation</strong> ('Do not discuss this with anyone'). High pressure tactics designed to induce cognitive tunneling.",
                    proto: "<strong>Verify Out-of-Band:</strong> Never process financial requests based solely on email. Call a known number (not one in the email) or use internal chat to verify identity.",
                    why: "You refused to let rank override security protocols. Hybris punished."
                }
            },
            'it': {
                defensiveOptions: [
                    { text: "Provide the 2FA code quickly to avoid the server lockout.", correct: false },
                    { text: "Ask: 'What is the Ticket ID for this incident?' and verify in the portal.", correct: true },
                    { text: "Argue with them that your account is working fine.", correct: false }
                ],
                analysis: {
                    tech: "<strong>Quid Pro Quo & Fear:</strong> Offering a service (fixing the error) in exchange for information (2FA token). Exploits fear of losing access.",
                    ling: "<strong>Technobabble:</strong> Using terms like '403 errors', 'Active Directory', and 'resync' to overwhelm the victim and appear legitimate.",
                    proto: "<strong>Zero Trust:</strong> IT Support will NEVER ask for your password or 2FA code. If they do, it's a Red Team test or a real attack. Report immediately.",
                    why: "You challenged the source instead of complying with fear."
                }
            },
            'job': {
                defensiveOptions: [
                    { text: "Download the file to check the salary range, then delete it.", correct: false },
                    { text: "Respond asking for the job description in the text body, not an attachment.", correct: true },
                    { text: "Accept the interview request immediately.", correct: false }
                ],
                analysis: {
                    tech: "<strong>Curiosity & Greed:</strong> Leveraging a high-salary offer and 'confidential' info to trick you into executing a payload (Macro-enabled Doc).",
                    ling: "<strong>Flattery:</strong> 'Blown away by your profile'. <strong>Artificial Deadline:</strong> 'Closing tonight'. Both are designed to bypass logical analysis.",
                    proto: "<strong>Sandboxing:</strong> Never open unsolicited attachments, especially macro-enabled ones (.docm, .xlsm), even from 'recruiters'. Verify the role on the company site.",
                    why: "You recognized that if it looks too good to be true, it's bait."
                }
            },
            'wsp': {
                defensiveOptions: [
                    { text: "Change the IBAN immediately to ensure shipping isn't delayed.", correct: false },
                    { text: "Reply: 'I need to verify this change via official email/call with your Finance Controller.'", correct: true },
                    { text: "Ask Alex how his vacation was to see if it's really him.", correct: false }
                ],
                analysis: {
                    tech: "<strong>Rapport & Urgency:</strong> Using a known contact (Alex) and a casual channel (WhatsApp) to bypass formal change management controls.",
                    ling: "<strong>Casual Mimicry:</strong> Use of emojis and casual greeting ('Hey Tom!') mixed with a business crisis ('frozen account').",
                    proto: "<strong>Dual-Control:</strong> Bank account changes require verification via a second channel and approval from a second internal person. Never trust IM for payments.",
                    why: "You separated the relationship from the transaction."
                }
            }
        };

        // --- SIMULATOR LOGIC ---
        let currentSim = 'ceo';

        function loadSim(simId) {
            currentSim = simId;
            document.querySelectorAll('.scenario-item').forEach(el => el.classList.remove('active'));
            document.getElementById('btn-' + simId).classList.add('active');
            document.querySelectorAll('.os-window').forEach(el => el.classList.remove('active'));
            document.getElementById('sim-' + simId).classList.add('active');
            document.getElementById('analysis-select').value = "";
        }

        function submitAnalysis() {
            const val = document.getElementById('analysis-select').value;
            const toast = document.getElementById('toast');
            
            let correct = false;
            if (currentSim === 'ceo' && (val === 'authority' || val === 'urgency')) correct = true;
            if (currentSim === 'it' && (val === 'urgency' || val === 'quidproquo')) correct = true;
            if (currentSim === 'job' && (val === 'scarcity' || val === 'curiosity')) correct = true;
            if (currentSim === 'wsp' && (val === 'urgency' || val === 'rapport')) correct = true;

            if (correct) {
                // Success -> Launch Defense Phase
                showToast("Analysis Verified. Initiating Countermeasures...", "success");
                setTimeout(() => openDefenseModal(), 1500);
            } else {
                // Fail
                showToast("Analysis Failed. Review the indicators.", "error");
            }
        }

        function showToast(text, type) {
            const toast = document.getElementById('toast');
            const title = document.getElementById('toast-title');
            const msg = document.getElementById('toast-msg');
            const icon = document.getElementById('toast-icon');

            toast.className = type === "success" ? "toast show" : "toast show error";
            title.innerText = type === "success" ? "THREAT IDENTIFIED" : "SYSTEM ALERT";
            title.style.color = type === "success" ? "var(--accent-green)" : "var(--accent-red)";
            msg.innerText = text;
            icon.innerText = type === "success" ? "üõ°Ô∏è" : "‚ùå";
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // --- MODAL LOGIC ---
        function openDefenseModal() {
            const data = scenarioData[currentSim];
            const container = document.getElementById('defense-options-container');
            container.innerHTML = '';

            document.getElementById('modal-overlay').style.display = 'flex';
            document.getElementById('modal-defense').style.display = 'block';
            document.getElementById('modal-analysis').style.display = 'none';

            data.defensiveOptions.forEach((opt, index) => {
                const btn = document.createElement('div');
                btn.className = 'def-btn';
                btn.innerHTML = `<span class="def-icon">üí¨</span> ${opt.text}`;
                btn.onclick = () => checkDefenseChoice(index);
                container.appendChild(btn);
            });
        }

        function checkDefenseChoice(index) {
            const data = scenarioData[currentSim];
            if (data.defensiveOptions[index].correct) {
                // Correct Defense -> Show Coach
                document.getElementById('modal-defense').style.display = 'none';
                document.getElementById('modal-analysis').style.display = 'block';
                
                // Populate Coach
                document.getElementById('coach-tech').innerHTML = data.analysis.tech;
                document.getElementById('coach-ling').innerHTML = data.analysis.ling;
                document.getElementById('coach-proto').innerHTML = data.analysis.proto;
                document.getElementById('coach-why').innerText = data.analysis.why;
            } else {
                showToast("Ineffective Defense. The attacker bypassed you.", "error");
            }
        }

        function closeModal() {
            document.getElementById('modal-overlay').style.display = 'none';
        }

    </script>
</body>
</html>
